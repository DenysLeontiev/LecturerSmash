<div class="container">
  <div class="header-section">
    <h1>Top Workers</h1>
    
    <div class="selection-controls">
      <div class="form-group">
        <label for="institute-select">Institute:</label>
        <select 
          id="institute-select"
          [value]="selectedInstitute()?.id || ''"
          (change)="onInstituteChange($event)"
          [disabled]="institutesLoading()"
          class="form-select">
          <option value="">Select Institute...</option>
          @for (institute of institutes(); track institute.id) {
            <option [value]="institute.id">{{ institute.name }}</option>
          }
        </select>
      </div>

      <div class="form-group">
        <label for="department-select">Department:</label>
        <select 
          id="department-select"
          [value]="selectedDepartment()?.id || ''"
          (change)="onDepartmentChange($event)"
          [disabled]="departmentsLoading() || !selectedInstitute()"
          class="form-select">
          <option value="">Select Department...</option>
          @for (department of departments(); track department.id) {
            <option [value]="department.id">{{ department.longName }}</option>
          }
        </select>
      </div>
    </div>

    @if (institutesLoading() || departmentsLoading()) {
      <div class="loading">Loading...</div>
    }
  </div>

  @if (selectedDepartment()) {
    <div class="section">
      <h2>Top Rated Teachers</h2>
      @if (workersLoading()) {
        <div class="loading">Loading workers...</div>
      }
      <div class="workers-grid">
        @for (worker of workers(); track worker.id; let i = $index) {
          <div class="worker-card">
            <div class="rank">{{ i + 1 }}</div>
            <img 
              src="{{worker.photo.url}}" 
              [alt]="worker.photo.url"
              class="photo">
            <h3>{{ worker.fullName }}</h3>
            <p class="position">{{ worker.position }}</p>
            <div class="stats">
              <span><fa-icon icon="thumbs-up" class="like-icon"></fa-icon> {{ worker.numberOfLikes }}</span>
              <span><fa-icon icon="thumbs-down" class="dislike-icon"></fa-icon> {{ worker.numberOfDislikes }}</span>
            </div>
          </div>
        }
        @if (workers().length === 0 && !workersLoading()) {
          <div class="no-data">No workers found</div>
        }
      </div>
    </div>
  }
</div>
